<?php
require_once "config.php";
require_once "session.php";
if($_SERVER["REQUEST_METHOD"] == "POST" && isset($_POST['submit'])) {
  $fullname = trim($_POST['name']);
  $username = trim($_POST['username']);
  $password = trim($_POST['password']);
  $confirm_password = trim($_POST['confirm password']);
  if(strlen($password) < 6){
    $error .= '<p class="error">Password must have at least 6 characters.</p>';
  }
  if(empty($confirm_password)) {
    $error .= '<p class="error">Please enter confirm password.</p>';
  } else {
    if(empty($error) && ($password != $confirm_password)) {
      $error .= '<p class="error">Password did not match.</p>';
    }
  }
  if(empty($error)){
    $insertQuery = $db->prepare("INSERT INTO user(name, username, password) VALUES(?, ?, ?);");
    $insertQuery->bind_param("sss", $fullname, $username, $password);
    $result = $insertQuery->execute();
    if($result) {
      $error .= '<p class="error">Your registered successfully!</p>';
    } else {
      $error .= '<p class="error">Something went wrong!</p>';
    }
  }
  $query->close();
  $insertQuery->close();
  mysqli_close($db);
}
?>